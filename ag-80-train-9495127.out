[rank: 0] Global seed set to 0
/projects/dali/spack/var/spack/environments/dali/.spack-env/view/lib/python3.10/site-packages/lightning/fabric/plugins/environments/slurm.py:165: PossibleUserWarning: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python train.py config_file=conf/agrifieldnet.yaml module.m ...
  rank_zero_warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/projects/dali/spack/var/spack/environments/dali/.spack-env/view/lib/python3.10/site-packages/lightning/fabric/plugins/environments/slurm.py:165: PossibleUserWarning: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python train.py config_file=conf/agrifieldnet.yaml module.m ...
  rank_zero_warn(
You are using a CUDA device ('NVIDIA A100 80GB PCIe') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
/projects/dali/spack/var/spack/environments/dali/.spack-env/view/lib/python3.10/site-packages/lightning/pytorch/callbacks/model_checkpoint.py:615: UserWarning: Checkpoint directory /scratch/users/yichia3/agrifieldnet/output/train_agrifieldnet_unet_resnet50_0.0001_ce_False_0.001_0.1_0 exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name          | Type             | Params
---------------------------------------------------
0 | model         | Unet             | 32.6 M
1 | loss          | CrossEntropyLoss | 0     
2 | train_metrics | MetricCollection | 0     
3 | val_metrics   | MetricCollection | 0     
4 | test_metrics  | MetricCollection | 0     
---------------------------------------------------
32.6 M    Trainable params
0         Non-trainable params
32.6 M    Total params
130.204   Total estimated model params size (MB)
WARNING! The experiment directory, /home/yichia3/scratch/agrifieldnet/output/train_agrifieldnet_unet_resnet50_0.0001_ce_False_0.001_0.1_0, already exists, we might overwrite data in it!
================== current split:  train
0.8
======== test train length ============
932 116 117
Sanity Checking: 0it [00:00, ?it/s]Sanity Checking:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:01<00:01,  1.96s/it]Sanity Checking DataLoader 0: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:02<00:00,  1.16s/it]                                                                           /projects/dali/spack/var/spack/environments/dali/.spack-env/view/lib/python3.10/site-packages/lightning/pytorch/loops/fit_loop.py:280: PossibleUserWarning: The number of training batches (30) is smaller than the logging interval Trainer(log_every_n_steps=50). Set a lower value for log_every_n_steps if you want to see logs for the training epoch.
  rank_zero_warn(
Training: 0it [00:00, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/30 [00:00<?, ?it/s] Epoch 0:   3%|â–Ž         | 1/30 [00:03<01:55,  3.98s/it]Epoch 0:   3%|â–Ž         | 1/30 [00:03<01:55,  3.98s/it, v_num=8_9]Epoch 0:   7%|â–‹         | 2/30 [00:04<00:57,  2.04s/it, v_num=8_9]Epoch 0:   7%|â–‹         | 2/30 [00:04<00:57,  2.04s/it, v_num=8_9]Epoch 0:  10%|â–ˆ         | 3/30 [00:04<00:37,  1.40s/it, v_num=8_9]Epoch 0:  10%|â–ˆ         | 3/30 [00:04<00:37,  1.40s/it, v_num=8_9]Epoch 0:  13%|â–ˆâ–Ž        | 4/30 [00:04<00:28,  1.09s/it, v_num=8_9]Epoch 0:  13%|â–ˆâ–Ž        | 4/30 [00:04<00:28,  1.09s/it, v_num=8_9]Epoch 0:  17%|â–ˆâ–‹        | 5/30 [00:04<00:22,  1.10it/s, v_num=8_9]Epoch 0:  17%|â–ˆâ–‹        | 5/30 [00:04<00:22,  1.10it/s, v_num=8_9]Epoch 0:  20%|â–ˆâ–ˆ        | 6/30 [00:04<00:18,  1.28it/s, v_num=8_9]Epoch 0:  20%|â–ˆâ–ˆ        | 6/30 [00:04<00:18,  1.28it/s, v_num=8_9]Epoch 0:  23%|â–ˆâ–ˆâ–Ž       | 7/30 [00:04<00:15,  1.45it/s, v_num=8_9]Epoch 0:  23%|â–ˆâ–ˆâ–Ž       | 7/30 [00:04<00:15,  1.45it/s, v_num=8_9]Epoch 0:  27%|â–ˆâ–ˆâ–‹       | 8/30 [00:05<00:13,  1.59it/s, v_num=8_9]Epoch 0:  27%|â–ˆâ–ˆâ–‹       | 8/30 [00:05<00:13,  1.59it/s, v_num=8_9]Epoch 0:  30%|â–ˆâ–ˆâ–ˆ       | 9/30 [00:05<00:12,  1.74it/s, v_num=8_9]Epoch 0:  30%|â–ˆâ–ˆâ–ˆ       | 9/30 [00:05<00:12,  1.74it/s, v_num=8_9]Epoch 0:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 10/30 [00:05<00:10,  1.87it/s, v_num=8_9]Epoch 0:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 10/30 [00:05<00:10,  1.87it/s, v_num=8_9]Epoch 0:  37%|â–ˆâ–ˆâ–ˆâ–‹      | 11/30 [00:05<00:09,  1.99it/s, v_num=8_9]Epoch 0:  37%|â–ˆâ–ˆâ–ˆâ–‹      | 11/30 [00:05<00:09,  1.99it/s, v_num=8_9]Epoch 0:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 12/30 [00:05<00:08,  2.12it/s, v_num=8_9]Epoch 0:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 12/30 [00:05<00:08,  2.12it/s, v_num=8_9]Epoch 0:  43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 13/30 [00:05<00:07,  2.24it/s, v_num=8_9]Epoch 0:  43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 13/30 [00:05<00:07,  2.24it/s, v_num=8_9]Epoch 0:  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 14/30 [00:05<00:06,  2.36it/s, v_num=8_9]Epoch 0:  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 14/30 [00:05<00:06,  2.36it/s, v_num=8_9]Epoch 0:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 15/30 [00:06<00:06,  2.46it/s, v_num=8_9]Epoch 0:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 15/30 [00:06<00:06,  2.46it/s, v_num=8_9]Epoch 0:  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 16/30 [00:06<00:05,  2.57it/s, v_num=8_9]Epoch 0:  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 16/30 [00:06<00:05,  2.57it/s, v_num=8_9]Epoch 0:  57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 17/30 [00:06<00:04,  2.67it/s, v_num=8_9]Epoch 0:  57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 17/30 [00:06<00:04,  2.67it/s, v_num=8_9]Epoch 0:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 18/30 [00:06<00:04,  2.77it/s, v_num=8_9]Epoch 0:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 18/30 [00:06<00:04,  2.77it/s, v_num=8_9]Epoch 0:  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 19/30 [00:06<00:03,  2.86it/s, v_num=8_9]Epoch 0:  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 19/30 [00:06<00:03,  2.86it/s, v_num=8_9]Epoch 0:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 20/30 [00:06<00:03,  2.94it/s, v_num=8_9]Epoch 0:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 20/30 [00:06<00:03,  2.94it/s, v_num=8_9]Epoch 0:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 21/30 [00:07<00:03,  2.82it/s, v_num=8_9]Epoch 0:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 21/30 [00:07<00:03,  2.82it/s, v_num=8_9]Epoch 0:  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 22/30 [00:07<00:02,  2.90it/s, v_num=8_9]Epoch 0:  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 22/30 [00:07<00:02,  2.90it/s, v_num=8_9]Epoch 0:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 23/30 [00:07<00:02,  2.98it/s, v_num=8_9]Epoch 0:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 23/30 [00:07<00:02,  2.98it/s, v_num=8_9]Epoch 0:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 24/30 [00:07<00:01,  3.05it/s, v_num=8_9]Epoch 0:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 24/30 [00:07<00:01,  3.05it/s, v_num=8_9]Epoch 0:  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 25/30 [00:07<00:01,  3.13it/s, v_num=8_9]Epoch 0:  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 25/30 [00:07<00:01,  3.13it/s, v_num=8_9]Epoch 0:  87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 26/30 [00:08<00:01,  3.20it/s, v_num=8_9]Epoch 0:  87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 26/30 [00:08<00:01,  3.20it/s, v_num=8_9]Epoch 0:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 27/30 [00:08<00:00,  3.26it/s, v_num=8_9]Epoch 0:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 27/30 [00:08<00:00,  3.26it/s, v_num=8_9]Epoch 0:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 28/30 [00:08<00:00,  3.33it/s, v_num=8_9]Epoch 0:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 28/30 [00:08<00:00,  3.22it/s, v_num=8_9]Epoch 0:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 29/30 [00:08<00:00,  3.30it/s, v_num=8_9]Epoch 0:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 29/30 [00:08<00:00,  3.30it/s, v_num=8_9]Epoch 0: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 30/30 [00:09<00:00,  3.31it/s, v_num=8_9]Epoch 0: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 30/30 [00:09<00:00,  3.31it/s, v_num=8_9]
Validation: 0it [00:00, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A