[rank: 0] Global seed set to 0
/projects/dali/spack/var/spack/environments/dali/.spack-env/view/lib/python3.10/site-packages/lightning/fabric/plugins/environments/slurm.py:165: PossibleUserWarning: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python train.py config_file=conf/agrifieldnet.yaml module.m ...
  rank_zero_warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/projects/dali/spack/var/spack/environments/dali/.spack-env/view/lib/python3.10/site-packages/lightning/fabric/plugins/environments/slurm.py:165: PossibleUserWarning: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python train.py config_file=conf/agrifieldnet.yaml module.m ...
  rank_zero_warn(
You are using a CUDA device ('NVIDIA A100 80GB PCIe') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
/projects/dali/spack/var/spack/environments/dali/.spack-env/view/lib/python3.10/site-packages/lightning/pytorch/callbacks/model_checkpoint.py:615: UserWarning: Checkpoint directory /scratch/users/yichia3/agrifieldnet/output/train_agrifieldnet_unet_resnet50_0.0001_ce_False_0.001_0.1_0 exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name          | Type             | Params
---------------------------------------------------
0 | model         | Unet             | 32.6 M
1 | loss          | CrossEntropyLoss | 0     
2 | train_metrics | MetricCollection | 0     
3 | val_metrics   | MetricCollection | 0     
4 | test_metrics  | MetricCollection | 0     
---------------------------------------------------
32.6 M    Trainable params
0         Non-trainable params
32.6 M    Total params
130.204   Total estimated model params size (MB)
WARNING! The experiment directory, /home/yichia3/scratch/agrifieldnet/output/train_agrifieldnet_unet_resnet50_0.0001_ce_False_0.001_0.1_0, already exists, we might overwrite data in it!
================== current split:  train
0.1
======== test train length ============
116 116 117
Sanity Checking: 0it [00:00, ?it/s]Sanity Checking:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:  50%|█████     | 1/2 [00:01<00:01,  1.64s/it]Sanity Checking DataLoader 0: 100%|██████████| 2/2 [00:01<00:00,  1.02it/s]                                                                           /projects/dali/spack/var/spack/environments/dali/.spack-env/view/lib/python3.10/site-packages/lightning/pytorch/loops/fit_loop.py:280: PossibleUserWarning: The number of training batches (4) is smaller than the logging interval Trainer(log_every_n_steps=50). Set a lower value for log_every_n_steps if you want to see logs for the training epoch.
  rank_zero_warn(
Training: 0it [00:00, ?it/s]Training:   0%|          | 0/4 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/4 [00:00<?, ?it/s] Epoch 0:  25%|██▌       | 1/4 [00:02<00:07,  2.66s/it]Epoch 0:  25%|██▌       | 1/4 [00:02<00:07,  2.66s/it, v_num=2_3]Epoch 0:  50%|█████     | 2/4 [00:02<00:02,  1.37s/it, v_num=2_3]Epoch 0:  50%|█████     | 2/4 [00:02<00:02,  1.37s/it, v_num=2_3]Epoch 0:  75%|███████▌  | 3/4 [00:02<00:00,  1.04it/s, v_num=2_3]Epoch 0:  75%|███████▌  | 3/4 [00:02<00:00,  1.04it/s, v_num=2_3]Epoch 0: 100%|██████████| 4/4 [00:03<00:00,  1.27it/s, v_num=2_3]Epoch 0: 100%|██████████| 4/4 [00:03<00:00,  1.27it/s, v_num=2_3]
Validation: 0it [00:00, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|██▌       | 1/4 [00:00<00:00,  3.24it/s][A
Validation DataLoader 0:  50%|█████     | 2/4 [00:00<00:00,  3.20it/s][A
Validation DataLoader 0:  75%|███████▌  | 3/4 [00:00<00:00,  3.20it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.02it/s][AEpoch 0: 100%|██████████| 4/4 [00:06<00:00,  1.52s/it, v_num=2_3]
                                                                      [AEpoch 0: 100%|██████████| 4/4 [00:06<00:00,  1.52s/it, v_num=2_3]Epoch 0:   0%|          | 0/4 [00:00<?, ?it/s, v_num=2_3]        Epoch 1:   0%|          | 0/4 [00:00<?, ?it/s, v_num=2_3]Epoch 1:  25%|██▌       | 1/4 [00:03<00:11,  3.79s/it, v_num=2_3]Epoch 1:  25%|██▌       | 1/4 [00:03<00:11,  3.80s/it, v_num=2_3]Epoch 1:  50%|█████     | 2/4 [00:03<00:03,  1.96s/it, v_num=2_3]Epoch 1:  50%|█████     | 2/4 [00:03<00:03,  1.96s/it, v_num=2_3]Epoch 1:  75%|███████▌  | 3/4 [00:04<00:01,  1.35s/it, v_num=2_3]Epoch 1:  75%|███████▌  | 3/4 [00:04<00:01,  1.35s/it, v_num=2_3]Epoch 1: 100%|██████████| 4/4 [00:04<00:00,  1.04s/it, v_num=2_3]Epoch 1: 100%|██████████| 4/4 [00:04<00:00,  1.04s/it, v_num=2_3]
Validation: 0it [00:00, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|██▌       | 1/4 [00:00<00:01,  3.00it/s][A
Validation DataLoader 0:  50%|█████     | 2/4 [00:00<00:00,  3.03it/s][A
Validation DataLoader 0:  75%|███████▌  | 3/4 [00:00<00:00,  3.06it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.09it/s][AEpoch 1: 100%|██████████| 4/4 [00:08<00:00,  2.18s/it, v_num=2_3]
                                                                      [AEpoch 1: 100%|██████████| 4/4 [00:08<00:00,  2.18s/it, v_num=2_3]Epoch 1:   0%|          | 0/4 [00:00<?, ?it/s, v_num=2_3]        Epoch 2:   0%|          | 0/4 [00:00<?, ?it/s, v_num=2_3]Epoch 2:  25%|██▌       | 1/4 [00:01<00:04,  1.54s/it, v_num=2_3]Epoch 2:  25%|██▌       | 1/4 [00:01<00:04,  1.54s/it, v_num=2_3]Epoch 2:  50%|█████     | 2/4 [00:01<00:01,  1.20it/s, v_num=2_3]Epoch 2:  50%|█████     | 2/4 [00:01<00:01,  1.20it/s, v_num=2_3]Epoch 2:  75%|███████▌  | 3/4 [00:01<00:00,  1.66it/s, v_num=2_3]Epoch 2:  75%|███████▌  | 3/4 [00:01<00:00,  1.66it/s, v_num=2_3]Epoch 2: 100%|██████████| 4/4 [00:01<00:00,  2.09it/s, v_num=2_3]Epoch 2: 100%|██████████| 4/4 [00:01<00:00,  2.09it/s, v_num=2_3]
Validation: 0it [00:00, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|██▌       | 1/4 [00:00<00:00,  3.13it/s][A
Validation DataLoader 0:  50%|█████     | 2/4 [00:00<00:00,  3.09it/s][A
Validation DataLoader 0:  75%|███████▌  | 3/4 [00:00<00:00,  3.10it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.14it/s][AEpoch 2: 100%|██████████| 4/4 [00:04<00:00,  1.22s/it, v_num=2_3]
                                                                      [AEpoch 2: 100%|██████████| 4/4 [00:04<00:00,  1.22s/it, v_num=2_3]Epoch 2:   0%|          | 0/4 [00:00<?, ?it/s, v_num=2_3]        Epoch 3:   0%|          | 0/4 [00:00<?, ?it/s, v_num=2_3]Epoch 3:  25%|██▌       | 1/4 [00:01<00:05,  1.70s/it, v_num=2_3]Epoch 3:  25%|██▌       | 1/4 [00:01<00:05,  1.70s/it, v_num=2_3]Epoch 3:  50%|█████     | 2/4 [00:01<00:01,  1.09it/s, v_num=2_3]Epoch 3:  50%|█████     | 2/4 [00:01<00:01,  1.08it/s, v_num=2_3]Epoch 3:  75%|███████▌  | 3/4 [00:01<00:00,  1.52it/s, v_num=2_3]Epoch 3:  75%|███████▌  | 3/4 [00:01<00:00,  1.52it/s, v_num=2_3]Epoch 3: 100%|██████████| 4/4 [00:02<00:00,  1.92it/s, v_num=2_3]Epoch 3: 100%|██████████| 4/4 [00:02<00:00,  1.92it/s, v_num=2_3]
Validation: 0it [00:00, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|██▌       | 1/4 [00:00<00:00,  3.08it/s][A
Validation DataLoader 0:  50%|█████     | 2/4 [00:00<00:00,  3.12it/s][A
Validation DataLoader 0:  75%|███████▌  | 3/4 [00:00<00:00,  3.13it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.15it/s][AEpoch 3: 100%|██████████| 4/4 [00:04<00:00,  1.24s/it, v_num=2_3]
                                                                      [AEpoch 3: 100%|██████████| 4/4 [00:04<00:00,  1.24s/it, v_num=2_3]Epoch 3:   0%|          | 0/4 [00:00<?, ?it/s, v_num=2_3]        Epoch 4:   0%|          | 0/4 [00:00<?, ?it/s, v_num=2_3]Epoch 4:  25%|██▌       | 1/4 [00:01<00:05,  1.72s/it, v_num=2_3]Epoch 4:  25%|██▌       | 1/4 [00:01<00:05,  1.72s/it, v_num=2_3]Epoch 4:  50%|█████     | 2/4 [00:01<00:01,  1.08it/s, v_num=2_3]Epoch 4:  50%|█████     | 2/4 [00:01<00:01,  1.08it/s, v_num=2_3]Epoch 4:  75%|███████▌  | 3/4 [00:01<00:00,  1.51it/s, v_num=2_3]Epoch 4:  75%|███████▌  | 3/4 [00:01<00:00,  1.51it/s, v_num=2_3]Epoch 4: 100%|██████████| 4/4 [00:02<00:00,  1.91it/s, v_num=2_3]Epoch 4: 100%|██████████| 4/4 [00:02<00:00,  1.91it/s, v_num=2_3]
Validation: 0it [00:00, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|██▌       | 1/4 [00:00<00:00,  3.18it/s][A
Validation DataLoader 0:  50%|█████     | 2/4 [00:00<00:00,  3.09it/s][A
Validation DataLoader 0:  75%|███████▌  | 3/4 [00:01<00:00,  2.27it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.45it/s][AEpoch 4: 100%|██████████| 4/4 [00:05<00:00,  1.36s/it, v_num=2_3]
                                                                      [AEpoch 4: 100%|██████████| 4/4 [00:05<00:00,  1.37s/it, v_num=2_3]Epoch 4:   0%|          | 0/4 [00:00<?, ?it/s, v_num=2_3]        Epoch 5:   0%|          | 0/4 [00:00<?, ?it/s, v_num=2_3]Epoch 5:  25%|██▌       | 1/4 [00:01<00:05,  1.76s/it, v_num=2_3]Epoch 5:  25%|██▌       | 1/4 [00:01<00:05,  1.76s/it, v_num=2_3]Epoch 5:  50%|█████     | 2/4 [00:01<00:01,  1.06it/s, v_num=2_3]Epoch 5:  50%|█████     | 2/4 [00:01<00:01,  1.06it/s, v_num=2_3]Epoch 5:  75%|███████▌  | 3/4 [00:02<00:00,  1.48it/s, v_num=2_3]Epoch 5:  75%|███████▌  | 3/4 [00:02<00:00,  1.48it/s, v_num=2_3]Epoch 5: 100%|██████████| 4/4 [00:02<00:00,  1.87it/s, v_num=2_3]Epoch 5: 100%|██████████| 4/4 [00:02<00:00,  1.87it/s, v_num=2_3]
Validation: 0it [00:00, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|██▌       | 1/4 [00:00<00:01,  2.90it/s][A
Validation DataLoader 0:  50%|█████     | 2/4 [00:00<00:00,  2.97it/s][A
Validation DataLoader 0:  75%|███████▌  | 3/4 [00:01<00:00,  2.98it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.05it/s][AEpoch 5: 100%|██████████| 4/4 [00:05<00:00,  1.26s/it, v_num=2_3]
                                                                      [AEpoch 5: 100%|██████████| 4/4 [00:05<00:00,  1.26s/it, v_num=2_3]Epoch 5:   0%|          | 0/4 [00:00<?, ?it/s, v_num=2_3]        Epoch 6:   0%|          | 0/4 [00:00<?, ?it/s, v_num=2_3]Epoch 6:  25%|██▌       | 1/4 [00:01<00:04,  1.65s/it, v_num=2_3]Epoch 6:  25%|██▌       | 1/4 [00:01<00:04,  1.65s/it, v_num=2_3]Epoch 6:  50%|█████     | 2/4 [00:01<00:01,  1.13it/s, v_num=2_3]Epoch 6:  50%|█████     | 2/4 [00:01<00:01,  1.13it/s, v_num=2_3]Epoch 6:  75%|███████▌  | 3/4 [00:01<00:00,  1.57it/s, v_num=2_3]Epoch 6:  75%|███████▌  | 3/4 [00:01<00:00,  1.57it/s, v_num=2_3]Epoch 6: 100%|██████████| 4/4 [00:02<00:00,  1.97it/s, v_num=2_3]Epoch 6: 100%|██████████| 4/4 [00:02<00:00,  1.97it/s, v_num=2_3]
Validation: 0it [00:00, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|██▌       | 1/4 [00:00<00:01,  2.92it/s][A
Validation DataLoader 0:  50%|█████     | 2/4 [00:00<00:00,  3.02it/s][A
Validation DataLoader 0:  75%|███████▌  | 3/4 [00:00<00:00,  3.04it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.08it/s][AEpoch 6: 100%|██████████| 4/4 [00:04<00:00,  1.25s/it, v_num=2_3]
                                                                      [AEpoch 6: 100%|██████████| 4/4 [00:05<00:00,  1.25s/it, v_num=2_3]Epoch 6:   0%|          | 0/4 [00:00<?, ?it/s, v_num=2_3]        Epoch 7:   0%|          | 0/4 [00:00<?, ?it/s, v_num=2_3]Epoch 7:  25%|██▌       | 1/4 [00:01<00:04,  1.64s/it, v_num=2_3]Epoch 7:  25%|██▌       | 1/4 [00:01<00:04,  1.64s/it, v_num=2_3]Epoch 7:  50%|█████     | 2/4 [00:01<00:01,  1.13it/s, v_num=2_3]Epoch 7:  50%|█████     | 2/4 [00:01<00:01,  1.13it/s, v_num=2_3]Epoch 7:  75%|███████▌  | 3/4 [00:01<00:00,  1.57it/s, v_num=2_3]Epoch 7:  75%|███████▌  | 3/4 [00:01<00:00,  1.57it/s, v_num=2_3]Epoch 7: 100%|██████████| 4/4 [00:02<00:00,  1.98it/s, v_num=2_3]Epoch 7: 100%|██████████| 4/4 [00:02<00:00,  1.98it/s, v_num=2_3]
Validation: 0it [00:00, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|██▌       | 1/4 [00:00<00:00,  3.11it/s][A
Validation DataLoader 0:  50%|█████     | 2/4 [00:00<00:00,  3.13it/s][A
Validation DataLoader 0:  75%|███████▌  | 3/4 [00:00<00:00,  3.13it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.54it/s][AEpoch 7: 100%|██████████| 4/4 [00:05<00:00,  1.32s/it, v_num=2_3]
                                                                      [AEpoch 7: 100%|██████████| 4/4 [00:05<00:00,  1.32s/it, v_num=2_3]Epoch 7:   0%|          | 0/4 [00:00<?, ?it/s, v_num=2_3]        Epoch 8:   0%|          | 0/4 [00:00<?, ?it/s, v_num=2_3]Epoch 8:  25%|██▌       | 1/4 [00:01<00:05,  1.67s/it, v_num=2_3]Epoch 8:  25%|██▌       | 1/4 [00:01<00:05,  1.67s/it, v_num=2_3]Epoch 8:  50%|█████     | 2/4 [00:01<00:01,  1.11it/s, v_num=2_3]Epoch 8:  50%|█████     | 2/4 [00:01<00:01,  1.11it/s, v_num=2_3]Epoch 8:  75%|███████▌  | 3/4 [00:01<00:00,  1.55it/s, v_num=2_3]Epoch 8:  75%|███████▌  | 3/4 [00:01<00:00,  1.55it/s, v_num=2_3]Epoch 8: 100%|██████████| 4/4 [00:02<00:00,  1.95it/s, v_num=2_3]Epoch 8: 100%|██████████| 4/4 [00:02<00:00,  1.95it/s, v_num=2_3]
Validation: 0it [00:00, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|██▌       | 1/4 [00:00<00:01,  2.80it/s][A
Validation DataLoader 0:  50%|█████     | 2/4 [00:00<00:00,  2.83it/s][A
Validation DataLoader 0:  75%|███████▌  | 3/4 [00:01<00:00,  2.90it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.94it/s][AEpoch 8: 100%|██████████| 4/4 [00:05<00:00,  1.25s/it, v_num=2_3]
                                                                      [AEpoch 8: 100%|██████████| 4/4 [00:05<00:00,  1.25s/it, v_num=2_3]Epoch 8:   0%|          | 0/4 [00:00<?, ?it/s, v_num=2_3]        Epoch 9:   0%|          | 0/4 [00:00<?, ?it/s, v_num=2_3]Epoch 9:  25%|██▌       | 1/4 [00:01<00:05,  1.70s/it, v_num=2_3]Epoch 9:  25%|██▌       | 1/4 [00:01<00:05,  1.70s/it, v_num=2_3]Epoch 9:  50%|█████     | 2/4 [00:01<00:01,  1.09it/s, v_num=2_3]Epoch 9:  50%|█████     | 2/4 [00:01<00:01,  1.09it/s, v_num=2_3]Epoch 9:  75%|███████▌  | 3/4 [00:01<00:00,  1.52it/s, v_num=2_3]Epoch 9:  75%|███████▌  | 3/4 [00:01<00:00,  1.52it/s, v_num=2_3]Epoch 9: 100%|██████████| 4/4 [00:02<00:00,  1.92it/s, v_num=2_3]Epoch 9: 100%|██████████| 4/4 [00:02<00:00,  1.91it/s, v_num=2_3]
Validation: 0it [00:00, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|██▌       | 1/4 [00:00<00:01,  2.83it/s][A
Validation DataLoader 0:  50%|█████     | 2/4 [00:00<00:00,  2.94it/s][A
Validation DataLoader 0:  75%|███████▌  | 3/4 [00:00<00:00,  3.00it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.05it/s][AEpoch 9: 100%|██████████| 4/4 [00:05<00:00,  1.29s/it, v_num=2_3]
                                                                      [AEpoch 9: 100%|██████████| 4/4 [00:05<00:00,  1.29s/it, v_num=2_3]Epoch 9:   0%|          | 0/4 [00:00<?, ?it/s, v_num=2_3]        Epoch 10:   0%|          | 0/4 [00:00<?, ?it/s, v_num=2_3]Epoch 10:  25%|██▌       | 1/4 [00:01<00:05,  1.67s/it, v_num=2_3]Epoch 10:  25%|██▌       | 1/4 [00:01<00:05,  1.67s/it, v_num=2_3]Epoch 10:  50%|█████     | 2/4 [00:01<00:01,  1.11it/s, v_num=2_3]Epoch 10:  50%|█████     | 2/4 [00:01<00:01,  1.11it/s, v_num=2_3]Epoch 10:  75%|███████▌  | 3/4 [00:01<00:00,  1.54it/s, v_num=2_3]Epoch 10:  75%|███████▌  | 3/4 [00:01<00:00,  1.54it/s, v_num=2_3]Epoch 10: 100%|██████████| 4/4 [00:02<00:00,  1.94it/s, v_num=2_3]Epoch 10: 100%|██████████| 4/4 [00:02<00:00,  1.94it/s, v_num=2_3]
Validation: 0it [00:00, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|██▌       | 1/4 [00:00<00:01,  2.85it/s][A
Validation DataLoader 0:  50%|█████     | 2/4 [00:00<00:00,  2.97it/s][A
Validation DataLoader 0:  75%|███████▌  | 3/4 [00:00<00:00,  3.01it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.06it/s][AEpoch 10: 100%|██████████| 4/4 [00:05<00:00,  1.25s/it, v_num=2_3]
                                                                      [AEpoch 10: 100%|██████████| 4/4 [00:05<00:00,  1.25s/it, v_num=2_3]Epoch 10:   0%|          | 0/4 [00:00<?, ?it/s, v_num=2_3]        Epoch 11:   0%|          | 0/4 [00:00<?, ?it/s, v_num=2_3]Epoch 11:  25%|██▌       | 1/4 [00:01<00:04,  1.65s/it, v_num=2_3]Epoch 11:  25%|██▌       | 1/4 [00:01<00:04,  1.65s/it, v_num=2_3]Epoch 11:  50%|█████     | 2/4 [00:01<00:01,  1.12it/s, v_num=2_3]Epoch 11:  50%|█████     | 2/4 [00:01<00:01,  1.12it/s, v_num=2_3]Epoch 11:  75%|███████▌  | 3/4 [00:01<00:00,  1.56it/s, v_num=2_3]Epoch 11:  75%|███████▌  | 3/4 [00:01<00:00,  1.56it/s, v_num=2_3]Epoch 11: 100%|██████████| 4/4 [00:02<00:00,  1.97it/s, v_num=2_3]Epoch 11: 100%|██████████| 4/4 [00:02<00:00,  1.97it/s, v_num=2_3]
Validation: 0it [00:00, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|██▌       | 1/4 [00:00<00:01,  2.78it/s][A
Validation DataLoader 0:  50%|█████     | 2/4 [00:01<00:01,  1.94it/s][A
Validation DataLoader 0:  75%|███████▌  | 3/4 [00:01<00:00,  2.20it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.39it/s][AEpoch 11: 100%|██████████| 4/4 [00:05<00:00,  1.33s/it, v_num=2_3]
                                                                      [AEpoch 11: 100%|██████████| 4/4 [00:05<00:00,  1.33s/it, v_num=2_3]Epoch 11:   0%|          | 0/4 [00:00<?, ?it/s, v_num=2_3]        Epoch 12:   0%|          | 0/4 [00:00<?, ?it/s, v_num=2_3]Epoch 12:  25%|██▌       | 1/4 [00:01<00:04,  1.65s/it, v_num=2_3]Epoch 12:  25%|██▌       | 1/4 [00:01<00:04,  1.65s/it, v_num=2_3]Epoch 12:  50%|█████     | 2/4 [00:01<00:01,  1.12it/s, v_num=2_3]Epoch 12:  50%|█████     | 2/4 [00:01<00:01,  1.12it/s, v_num=2_3]Epoch 12:  75%|███████▌  | 3/4 [00:01<00:00,  1.56it/s, v_num=2_3]Epoch 12:  75%|███████▌  | 3/4 [00:01<00:00,  1.56it/s, v_num=2_3]Epoch 12: 100%|██████████| 4/4 [00:02<00:00,  1.96it/s, v_num=2_3]Epoch 12: 100%|██████████| 4/4 [00:02<00:00,  1.96it/s, v_num=2_3]
Validation: 0it [00:00, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|██▌       | 1/4 [00:00<00:01,  2.97it/s][A
Validation DataLoader 0:  50%|█████     | 2/4 [00:00<00:00,  2.96it/s][A
Validation DataLoader 0:  75%|███████▌  | 3/4 [00:00<00:00,  3.00it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.03it/s][AEpoch 12: 100%|██████████| 4/4 [00:05<00:00,  1.27s/it, v_num=2_3]
                                                                      [AEpoch 12: 100%|██████████| 4/4 [00:05<00:00,  1.27s/it, v_num=2_3]Epoch 12:   0%|          | 0/4 [00:00<?, ?it/s, v_num=2_3]        Epoch 13:   0%|          | 0/4 [00:00<?, ?it/s, v_num=2_3]Epoch 13:  25%|██▌       | 1/4 [00:01<00:05,  1.72s/it, v_num=2_3]Epoch 13:  25%|██▌       | 1/4 [00:01<00:05,  1.72s/it, v_num=2_3]Epoch 13:  50%|█████     | 2/4 [00:01<00:01,  1.08it/s, v_num=2_3]Epoch 13:  50%|█████     | 2/4 [00:01<00:01,  1.08it/s, v_num=2_3]Epoch 13:  75%|███████▌  | 3/4 [00:01<00:00,  1.51it/s, v_num=2_3]Epoch 13:  75%|███████▌  | 3/4 [00:01<00:00,  1.51it/s, v_num=2_3]Epoch 13: 100%|██████████| 4/4 [00:02<00:00,  1.90it/s, v_num=2_3]Epoch 13: 100%|██████████| 4/4 [00:02<00:00,  1.90it/s, v_num=2_3]
Validation: 0it [00:00, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|██▌       | 1/4 [00:00<00:01,  2.89it/s][A
Validation DataLoader 0:  50%|█████     | 2/4 [00:00<00:00,  2.97it/s][A
Validation DataLoader 0:  75%|███████▌  | 3/4 [00:00<00:00,  3.01it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.06it/s][AEpoch 13: 100%|██████████| 4/4 [00:05<00:00,  1.25s/it, v_num=2_3]
                                                                      [AEpoch 13: 100%|██████████| 4/4 [00:05<00:00,  1.25s/it, v_num=2_3]Epoch 13:   0%|          | 0/4 [00:00<?, ?it/s, v_num=2_3]        Epoch 14:   0%|          | 0/4 [00:00<?, ?it/s, v_num=2_3]Epoch 14:  25%|██▌       | 1/4 [00:01<00:05,  1.69s/it, v_num=2_3]Epoch 14:  25%|██▌       | 1/4 [00:01<00:05,  1.69s/it, v_num=2_3]Epoch 14:  50%|█████     | 2/4 [00:01<00:01,  1.10it/s, v_num=2_3]Epoch 14:  50%|█████     | 2/4 [00:01<00:01,  1.10it/s, v_num=2_3]Epoch 14:  75%|███████▌  | 3/4 [00:01<00:00,  1.53it/s, v_num=2_3]Epoch 14:  75%|███████▌  | 3/4 [00:01<00:00,  1.53it/s, v_num=2_3]Epoch 14: 100%|██████████| 4/4 [00:02<00:00,  1.93it/s, v_num=2_3]Epoch 14: 100%|██████████| 4/4 [00:02<00:00,  1.93it/s, v_num=2_3]
Validation: 0it [00:00, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|██▌       | 1/4 [00:00<00:00,  3.02it/s][A
Validation DataLoader 0:  50%|█████     | 2/4 [00:00<00:00,  3.05it/s][A
Validation DataLoader 0:  75%|███████▌  | 3/4 [00:00<00:00,  3.05it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.44it/s][AEpoch 14: 100%|██████████| 4/4 [00:05<00:00,  1.35s/it, v_num=2_3]
                                                                      [AEpoch 14: 100%|██████████| 4/4 [00:05<00:00,  1.35s/it, v_num=2_3]Epoch 14:   0%|          | 0/4 [00:00<?, ?it/s, v_num=2_3]        Epoch 15:   0%|          | 0/4 [00:00<?, ?it/s, v_num=2_3]Epoch 15:  25%|██▌       | 1/4 [00:01<00:04,  1.64s/it, v_num=2_3]Epoch 15:  25%|██▌       | 1/4 [00:01<00:04,  1.64s/it, v_num=2_3]Epoch 15:  50%|█████     | 2/4 [00:01<00:01,  1.13it/s, v_num=2_3]Epoch 15:  50%|█████     | 2/4 [00:01<00:01,  1.13it/s, v_num=2_3]Epoch 15:  75%|███████▌  | 3/4 [00:01<00:00,  1.57it/s, v_num=2_3]Epoch 15:  75%|███████▌  | 3/4 [00:01<00:00,  1.57it/s, v_num=2_3]Epoch 15: 100%|██████████| 4/4 [00:02<00:00,  1.97it/s, v_num=2_3]Epoch 15: 100%|██████████| 4/4 [00:02<00:00,  1.97it/s, v_num=2_3]
Validation: 0it [00:00, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|██▌       | 1/4 [00:00<00:01,  2.88it/s][A
Validation DataLoader 0:  50%|█████     | 2/4 [00:00<00:00,  2.93it/s][A
Validation DataLoader 0:  75%|███████▌  | 3/4 [00:01<00:00,  2.99it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.05it/s][AEpoch 15: 100%|██████████| 4/4 [00:05<00:00,  1.26s/it, v_num=2_3]
                                                                      [AEpoch 15: 100%|██████████| 4/4 [00:05<00:00,  1.26s/it, v_num=2_3]Epoch 15:   0%|          | 0/4 [00:00<?, ?it/s, v_num=2_3]        Epoch 16:   0%|          | 0/4 [00:00<?, ?it/s, v_num=2_3]Epoch 16:  25%|██▌       | 1/4 [00:01<00:05,  1.74s/it, v_num=2_3]Epoch 16:  25%|██▌       | 1/4 [00:01<00:05,  1.74s/it, v_num=2_3]Epoch 16:  50%|█████     | 2/4 [00:01<00:01,  1.07it/s, v_num=2_3]Epoch 16:  50%|█████     | 2/4 [00:01<00:01,  1.07it/s, v_num=2_3]Epoch 16:  75%|███████▌  | 3/4 [00:02<00:00,  1.49it/s, v_num=2_3]Epoch 16:  75%|███████▌  | 3/4 [00:02<00:00,  1.49it/s, v_num=2_3]Epoch 16: 100%|██████████| 4/4 [00:02<00:00,  1.88it/s, v_num=2_3]Epoch 16: 100%|██████████| 4/4 [00:02<00:00,  1.88it/s, v_num=2_3]
Validation: 0it [00:00, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|██▌       | 1/4 [00:00<00:01,  2.82it/s][A
Validation DataLoader 0:  50%|█████     | 2/4 [00:00<00:00,  2.95it/s][A
Validation DataLoader 0:  75%|███████▌  | 3/4 [00:01<00:00,  2.96it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.02it/s][AEpoch 16: 100%|██████████| 4/4 [00:05<00:00,  1.29s/it, v_num=2_3]
                                                                      [AEpoch 16: 100%|██████████| 4/4 [00:05<00:00,  1.29s/it, v_num=2_3]Epoch 16:   0%|          | 0/4 [00:00<?, ?it/s, v_num=2_3]        Epoch 17:   0%|          | 0/4 [00:00<?, ?it/s, v_num=2_3]Epoch 17:  25%|██▌       | 1/4 [00:01<00:05,  1.78s/it, v_num=2_3]Epoch 17:  25%|██▌       | 1/4 [00:01<00:05,  1.78s/it, v_num=2_3]Epoch 17:  50%|█████     | 2/4 [00:01<00:01,  1.05it/s, v_num=2_3]Epoch 17:  50%|█████     | 2/4 [00:01<00:01,  1.05it/s, v_num=2_3]Epoch 17:  75%|███████▌  | 3/4 [00:02<00:00,  1.47it/s, v_num=2_3]Epoch 17:  75%|███████▌  | 3/4 [00:02<00:00,  1.47it/s, v_num=2_3]Epoch 17: 100%|██████████| 4/4 [00:02<00:00,  1.85it/s, v_num=2_3]Epoch 17: 100%|██████████| 4/4 [00:02<00:00,  1.85it/s, v_num=2_3]
Validation: 0it [00:00, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|██▌       | 1/4 [00:00<00:01,  2.99it/s][A
Validation DataLoader 0:  50%|█████     | 2/4 [00:00<00:00,  3.05it/s][A
Validation DataLoader 0:  75%|███████▌  | 3/4 [00:00<00:00,  3.07it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.10it/s][AEpoch 17: 100%|██████████| 4/4 [00:05<00:00,  1.30s/it, v_num=2_3]
                                                                      [AEpoch 17: 100%|██████████| 4/4 [00:05<00:00,  1.30s/it, v_num=2_3]Epoch 17:   0%|          | 0/4 [00:00<?, ?it/s, v_num=2_3]        Epoch 18:   0%|          | 0/4 [00:00<?, ?it/s, v_num=2_3]Epoch 18:  25%|██▌       | 1/4 [00:01<00:05,  1.70s/it, v_num=2_3]Epoch 18:  25%|██▌       | 1/4 [00:01<00:05,  1.70s/it, v_num=2_3]Epoch 18:  50%|█████     | 2/4 [00:01<00:01,  1.09it/s, v_num=2_3]Epoch 18:  50%|█████     | 2/4 [00:01<00:01,  1.09it/s, v_num=2_3]Epoch 18:  75%|███████▌  | 3/4 [00:01<00:00,  1.52it/s, v_num=2_3]Epoch 18:  75%|███████▌  | 3/4 [00:01<00:00,  1.52it/s, v_num=2_3]Epoch 18: 100%|██████████| 4/4 [00:02<00:00,  1.92it/s, v_num=2_3]Epoch 18: 100%|██████████| 4/4 [00:02<00:00,  1.92it/s, v_num=2_3]
Validation: 0it [00:00, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|██▌       | 1/4 [00:00<00:01,  2.97it/s][A
Validation DataLoader 0:  50%|█████     | 2/4 [00:00<00:00,  2.08it/s][A
Validation DataLoader 0:  75%|███████▌  | 3/4 [00:01<00:00,  2.32it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.50it/s][AEpoch 18: 100%|██████████| 4/4 [00:05<00:00,  1.32s/it, v_num=2_3]
                                                                      [AEpoch 18: 100%|██████████| 4/4 [00:05<00:00,  1.33s/it, v_num=2_3]Epoch 18:   0%|          | 0/4 [00:00<?, ?it/s, v_num=2_3]        Epoch 19:   0%|          | 0/4 [00:00<?, ?it/s, v_num=2_3]Trainer was signaled to stop but the required `min_epochs=20` or `min_steps=None` has not been met. Training will continue...
Epoch 19:  25%|██▌       | 1/4 [00:01<00:05,  1.73s/it, v_num=2_3]Epoch 19:  25%|██▌       | 1/4 [00:01<00:05,  1.73s/it, v_num=2_3]Epoch 19:  50%|█████     | 2/4 [00:01<00:01,  1.07it/s, v_num=2_3]Epoch 19:  50%|█████     | 2/4 [00:01<00:01,  1.07it/s, v_num=2_3]Epoch 19:  75%|███████▌  | 3/4 [00:02<00:00,  1.49it/s, v_num=2_3]Epoch 19:  75%|███████▌  | 3/4 [00:02<00:00,  1.48it/s, v_num=2_3]Epoch 19: 100%|██████████| 4/4 [00:02<00:00,  1.87it/s, v_num=2_3]Epoch 19: 100%|██████████| 4/4 [00:02<00:00,  1.87it/s, v_num=2_3]
Validation: 0it [00:00, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:  25%|██▌       | 1/4 [00:00<00:01,  2.97it/s][A
Validation DataLoader 0:  50%|█████     | 2/4 [00:00<00:00,  3.02it/s][A
Validation DataLoader 0:  75%|███████▌  | 3/4 [00:00<00:00,  3.02it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.05it/s][AEpoch 19: 100%|██████████| 4/4 [00:05<00:00,  1.29s/it, v_num=2_3]
                                                                      [AEpoch 19: 100%|██████████| 4/4 [00:05<00:00,  1.29s/it, v_num=2_3]Epoch 19: 100%|██████████| 4/4 [00:05<00:00,  1.38s/it, v_num=2_3]Restoring states from the checkpoint path at /scratch/users/yichia3/agrifieldnet/output/train_agrifieldnet_unet_resnet50_0.0001_ce_False_0.001_0.1_0/checkpoint-epoch=00-val_loss=6.06-v1.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Loaded model weights from the checkpoint at /scratch/users/yichia3/agrifieldnet/output/train_agrifieldnet_unet_resnet50_0.0001_ce_False_0.001_0.1_0/checkpoint-epoch=00-val_loss=6.06-v1.ckpt

================== current split:  train
0.1
======== test train length ============
116 116 117
Testing: 0it [00:00, ?it/s]Testing:   0%|          | 0/4 [00:00<?, ?it/s]Testing DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s]Testing DataLoader 0:  25%|██▌       | 1/4 [00:00<00:00, 41.97it/s]Testing DataLoader 0:  50%|█████     | 2/4 [00:00<00:00, 24.54it/s]Testing DataLoader 0:  75%|███████▌  | 3/4 [00:00<00:00, 22.02it/s]Testing DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.60it/s]Testing DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.59it/s]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃         Test metric         ┃        DataLoader 0         ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│   test_MulticlassAccuracy   │    0.013763828203082085     │
│ test_MulticlassJaccardIndex │    0.006929602939635515     │
│          test_loss          │      6.04564094543457       │
└─────────────────────────────┴─────────────────────────────┘
Restoring states from the checkpoint path at /scratch/users/yichia3/agrifieldnet/output/train_agrifieldnet_unet_resnet50_0.0001_ce_False_0.001_0.1_0/checkpoint-epoch=00-val_loss=6.06-v1.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Loaded model weights from the checkpoint at /scratch/users/yichia3/agrifieldnet/output/train_agrifieldnet_unet_resnet50_0.0001_ce_False_0.001_0.1_0/checkpoint-epoch=00-val_loss=6.06-v1.ckpt
================== current split:  predict
getting splits...
Predicting: 0it [00:00, ?it/s]Predicting:   0%|          | 0/23 [00:00<?, ?it/s]Predicting DataLoader 0:   0%|          | 0/23 [00:00<?, ?it/s]Predicting DataLoader 0:   4%|▍         | 1/23 [00:00<00:01, 14.17it/s]Predicting DataLoader 0:   9%|▊         | 2/23 [00:00<00:01, 10.63it/s]Predicting DataLoader 0:  13%|█▎        | 3/23 [00:00<00:01, 10.06it/s]Predicting DataLoader 0:  17%|█▋        | 4/23 [00:00<00:02,  9.13it/s]Predicting DataLoader 0:  22%|██▏       | 5/23 [00:00<00:01,  9.10it/s]Predicting DataLoader 0:  26%|██▌       | 6/23 [00:00<00:01,  8.88it/s]Predicting DataLoader 0:  30%|███       | 7/23 [00:00<00:01,  8.87it/s]Predicting DataLoader 0:  35%|███▍      | 8/23 [00:00<00:01,  8.74it/s]Predicting DataLoader 0:  39%|███▉      | 9/23 [00:01<00:01,  8.85it/s]Predicting DataLoader 0:  43%|████▎     | 10/23 [00:01<00:01,  7.75it/s]Predicting DataLoader 0:  48%|████▊     | 11/23 [00:02<00:02,  4.79it/s]Predicting DataLoader 0:  52%|█████▏    | 12/23 [00:02<00:02,  4.99it/s]Predicting DataLoader 0:  57%|█████▋    | 13/23 [00:02<00:01,  5.19it/s]Predicting DataLoader 0:  61%|██████    | 14/23 [00:02<00:01,  5.32it/s]Predicting DataLoader 0:  65%|██████▌   | 15/23 [00:02<00:01,  5.45it/s]Predicting DataLoader 0:  70%|██████▉   | 16/23 [00:02<00:01,  5.56it/s]Predicting DataLoader 0:  74%|███████▍  | 17/23 [00:03<00:01,  5.67it/s]Predicting DataLoader 0:  78%|███████▊  | 18/23 [00:03<00:00,  5.80it/s]Predicting DataLoader 0:  83%|████████▎ | 19/23 [00:03<00:00,  5.91it/s]Predicting DataLoader 0:  87%|████████▋ | 20/23 [00:03<00:00,  6.02it/s]Predicting DataLoader 0:  91%|█████████▏| 21/23 [00:03<00:00,  5.96it/s]Predicting DataLoader 0:  96%|█████████▌| 22/23 [00:03<00:00,  6.04it/s]Predicting DataLoader 0: 100%|██████████| 23/23 [00:03<00:00,  6.12it/s]Predicting DataLoader 0: 100%|██████████| 23/23 [00:03<00:00,  6.12it/s]
creating submission...
Done
python train.py config_file=conf/agrifieldnet.yaml module.model=unet module.backbone=resnet50 module.learning_rate=0.0001 module.loss=ce module.weights=False module.train_split_pct=0.1 program.experiment_name=train_agrifieldnet_unet_resnet50_0.0001_ce_False_0.001_0.1_0 program.seed=0 trainer.devices=[0]
